import{b as d,u as P,d as E,x as R,e as g,o as B,c as G,a as p,f as a,g as s,q as o,F as I,s as r,t as c}from"./index-59b1a81b.js";import{_ as N}from"./ErrorMessage-f525a803.js";import{_ as k}from"./LoadingModal-bfb2afa3.js";import{D as n}from"./DataGraphService-649fbddf.js";const A={class:"grid"},$={class:"col-12"},T={class:"card"},q={class:"flex flex-row flex-wrap card-container"},H=p("div",{class:"w-6"},[p("h2",null,"Forecasting")],-1),K={class:"card"},U=p("h4",null,"12 Month Sales Forecast",-1),X={__name:"Forecast",setup(j){const f=d(null),D=d(null),y=d(null),C=d(!1),S=d(!1),h=d([]),v=d([]),b=d([]),w=d(),m=getComputedStyle(document.documentElement);P(),E(()=>{f.value=[],L(),w.value=F()});function M(){return{labels:b.value,datasets:[{label:"Sales",fill:!1,tension:.4,borderColor:m.getPropertyValue("--blue-500"),data:h.value},{label:"Operating Income",fill:!1,tension:.4,borderColor:m.getPropertyValue("--green-500"),data:v.value}]}}function F(){const i=m.getPropertyValue("--text-color"),t=m.getPropertyValue("--text-color-secondary"),u=m.getPropertyValue("--surface-border");return{maintainAspectRatio:!1,aspectRatio:.6,plugins:{legend:{labels:{color:i}}},scales:{x:{ticks:{color:t},grid:{color:u}},y:{ticks:{color:t,callback:function(_){return parseInt(_)>=1e3?"$"+_.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"$"+_}},grid:{color:u}}}}}async function L(){C.value=!0,S.value=!1,f.value&&(f.value=[]),b.value&&(b.value=[]),h.value&&(h.value=[]),v.value&&(v.value=[]);let i=y.value?y.value.code:"",t=await R.getForecast(i);t?(f.value=O(t),D.value=M()):S.value=!0,C.value=!1}function O(i){let t=[];if(i.forecastStatus==="DONE"){t=[...i.pastMonthForecast,...i.futureForecast];for(var u in t)b.value[u]=t[u].month,h.value[u]=t[u].netSales,v.value[u]=t[u].operatingIncome}return t}return(i,t)=>{const u=g("Dropdown"),_=g("Button"),V=g("Chart"),l=g("Column"),x=g("DataTable");return B(),G(I,null,[p("div",A,[p("div",$,[p("div",T,[a(N,{showErrorMessage:S.value},null,8,["showErrorMessage"]),p("div",q,[H,a(u,{onChange:L,modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=e=>y.value=e),options:s(n).salesChannelOptions,optionLabel:"name",placeholder:"Sales Channel"},null,8,["modelValue","options"]),a(_,{label:"Forecast Settings",severity:"secondary",outlined:""})]),p("div",K,[U,a(V,{type:"line",data:D.value,options:w.value},null,8,["data","options"])]),a(x,{stripedRows:"",value:f.value,paginator:!1,class:"p-datatable-gridlines",dataKey:"month",rowHover:!0,filterDisplay:"menu",responsiveLayout:"scroll"},{empty:o(()=>[r(" No forecast data. ")]),loading:o(()=>[r(" Loading forecast data. Please wait. ")]),default:o(()=>[a(l,{header:"Gross Sales"},{body:o(({data:e})=>[r(c(s(n).formatCurrency(e.grossSales.ALL)),1)]),_:1}),a(l,{header:"Refunds"},{body:o(({data:e})=>[r(c(s(n).formatCurrency(e.refunds)),1)]),_:1}),a(l,{header:"Reimbursements"},{body:o(({data:e})=>[r(c(s(n).formatCurrency(e.reimbursements.ALL)),1)]),_:1}),a(l,{header:"Promo Rebates"},{body:o(({data:e})=>[r(c(s(n).formatCurrency(e.promoRebates)),1)]),_:1}),a(l,{header:"Net Sales"},{body:o(({data:e})=>[r(c(s(n).formatCurrency(e.netSales)),1)]),_:1}),a(l,{header:"Cost Of Goods Sold"},{body:o(({data:e})=>[r(c(s(n).formatCurrency(e.costOfGoods.ALL)),1)]),_:1}),a(l,{header:"Gross Profit"},{body:o(({data:e})=>[r(c(s(n).formatCurrency(e.grossProfit)),1)]),_:1}),a(l,{header:"Gross Margin"},{body:o(({data:e})=>[r(c(s(n).formatCurrency(e.grossMargin)),1)]),_:1}),a(l,{header:"Seller Fees"},{body:o(({data:e})=>[r(c(s(n).formatCurrency(e.sellerFees)),1)]),_:1}),a(l,{header:"Advertising Spend"},{body:o(({data:e})=>[r(c(s(n).formatCurrency(e.advertisingSpend)),1)]),_:1}),a(l,{header:"Operating Expenses"},{body:o(({data:e})=>[r(c(s(n).formatCurrency(e.operatingExpenses)),1)]),_:1}),a(l,{header:"Operating Income"},{body:o(({data:e})=>[r(c(s(n).formatCurrency(e.operatingIncome)),1)]),_:1}),a(l,{header:"Operating Margin"},{body:o(({data:e})=>[r(c(s(n).formatCurrency(e.operatingMargin)),1)]),_:1})]),_:1},8,["value"])])])]),a(k,{showLoadingModal:C.value},null,8,["showLoadingModal"])],64)}}};export{X as default};
