import{i as ie,b as n,e as S,o as b,j as re,r as X,c as x,a as e,n as P,t as d,w as F,u as ue,d as ce,k as J,f as l,m as H,F as Q,l as de,p as pe,g as _,q as v,s as h}from"./index-59b1a81b.js";import{_ as ve}from"./ErrorMessage-f525a803.js";import{_ as fe}from"./LoadingModal-bfb2afa3.js";import{_ as ge}from"./CalendarDropdown-c8b3d21a.js";import{D as f}from"./DataGraphService-649fbddf.js";const me={__name:"SalesChannelDropdown",props:{salesChannelOption:{type:Object}},emits:["update:salesChannelOption"],setup(k,{emit:u}){const C=k,p=ie({get(){return C.salesChannelOption},set(y){u("update:salesChannelOption",y)}}),g=n([{name:"All",code:"ALL"},{name:"Amazon",code:"AMAZON"},{name:"Walmart",code:"WALMART"},{name:"Etsy",code:"ETSY"},{name:"Shopify",code:"SHOPIFY"}]);return(y,w)=>{const V=S("Dropdown");return b(),re(V,{class:"col-sm-12 col-md-12 m-1",modelValue:p.value,"onUpdate:modelValue":w[0]||(w[0]=L=>p.value=L),options:g.value,optionLabel:"name",placeholder:"Sales Channel"},null,8,["modelValue","options"])}}};const _e={class:"flex flex-column"},he={class:"mb-5"},be={class:""},Ce={class:"text-900 font-medium font-bold text-xl"},ye={class:"flex flex-row align-items-center"},Se={class:"block text-500 font-medium font-bold"},xe=e("p",null,"Â ",-1),Pe={class:"pi pi-info-circle"},W={__name:"SalesProfitSummaryWidget",props:{data:Number|String,title:String,icon:String,tooltip:String,bgColor:String},setup(k){const u=k;return(C,p)=>{const g=X("tooltip");return b(),x("div",{class:P(["card dashboard-widget-card mb-0",u.bgColor])},[e("div",_e,[e("div",he,[e("span",{class:P(u.icon)},null,2)]),e("div",be,[e("span",Ce,d(u.data),1)]),e("div",ye,[e("span",Se,d(u.title),1),xe,F(e("i",Pe,null,512),[[g,{value:u.tooltip},void 0,{top:!0}]])])])],2)}}};const we={class:"grid"},Te={class:"col-12"},De={class:"card"},$e={class:"flex justify-content-between align-items-center mb-3"},Me=e("div",null,[e("h2",{style:{margin:"unset"}},"Sales & Profit")],-1),Oe={class:"flex flex-colunm flex-wrap justify-content-around"},ke={class:"flex flex-row flex-wrap"},Ve={class:"dashboard-widget"},Le={class:"dashboard-widget"},Re={class:"dashboard-widget"},Ne={class:"flex col-12"},Ue={class:"card col-8 m-0"},Ae={class:"flex justify-content-between"},Ee=e("h4",null,"Product Sales & Profitability",-1),Ge={class:"card col-4 ml-3"},je={class:"flex justify-content-between"},Be=e("h4",null,"Gross Margin",-1),Ie={class:"card flex gross-margin-card"},ze={class:"col-8 sales-profit-product-name"},He={class:"col-4 text-center"},We={class:"col-12"},Fe={class:"p-input-icon-left md:w-9"},Ke=e("i",{class:"pi pi-search"},null,-1),Ye={class:"sales-profit-product-name"},Ze={class:"text-red-500"},qe={class:"text-red-500"},ot={__name:"SalesProfit",setup(k){const u=n(null),C=n(null),p=n({name:"Month To Date",code:"MTD"}),g=n(null),y=n(""),w=n(0),V=n(null),L=n(20),c=n(),G=n(!1),j=n(!1),R=n([]),N=n([]),U=n([]),K=n(),T=getComputedStyle(document.documentElement),D=n(!0),$=n(null),B=n(null),M=n(!0);ue(),ce(()=>{u.value=[],m(),K.value=ee()});function Y(a){return oe(a),{labels:U.value,datasets:[{type:"bar",label:"Profit",backgroundColor:T.getPropertyValue("--blue-500"),data:R.value},{type:"bar",label:"Sales",backgroundColor:T.getPropertyValue("--green-500"),data:N.value}]}}function ee(){const a=T.getPropertyValue("--text-color"),t=T.getPropertyValue("--text-color-secondary"),i=T.getPropertyValue("--surface-border");return{maintainAspectRatio:!1,aspectRatio:.8,plugins:{tooltips:{mode:"index",intersect:!1},legend:{labels:{color:a}}},scales:{x:{stacked:!0,ticks:{color:t},grid:{color:i}},y:{stacked:!1,beginAtZero:!0,ticks:{color:t,callback:function(s){return parseInt(s)>=1e3?"$"+s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"$"+s}},grid:{color:i}}}}}async function m(){var E,O,o,Z,q;if(((E=p.value)==null?void 0:E.code)==="CUSTOM"&&(!((O=c.value)!=null&&O[0])||!((o=c.value)!=null&&o[1])))return;G.value=!0,j.value=!1,u.value&&(u.value=[]),U.value&&(U.value=[]),R.value&&(R.value=[]),N.value&&(N.value=[]);let a=p.value?p.value.code:"MTD",t=g.value?g.value.code:"",i=(Z=c==null?void 0:c.value)!=null&&Z[0]?f.extractCalendarDateString(c.value[0]):null,s=(q=c==null?void 0:c.value)!=null&&q[1]?f.extractCalendarDateString(c.value[1]):null,r=await J.getSales(a,t,i,s,y.value,w.value,L.value),A=await J.getProfitability(a,t,i,s);r!=null&&r.items&&A?(V.value=r.size,u.value=te(r),$.value=A,I(D.value),z(M.value)):j.value=!0,G.value=!1}function te(a){let t=[];for(var i in a.items){let s={};s.name=a.items[i].productName,s.upc=a.items[i].sku,s.unitsSold=a.items[i].unitsSold,s.totalSales=a.items[i].sales,s.unitsRefunded=a.items[i].unitsRefunded,s.elc=a.items[i].elc,s.totalCosts=a.items[i].totalCosts,s.totalProfit=a.items[i].totalProfit,s.roi=a.items[i].roi,s.grossMargin=a.items[i].grossMargin,t.push(s)}return t}function oe(a){for(let t in a)U.value[t]=a[t].sku,R.value[t]=a[t].totalProfit,N.value[t]=a[t].sales}function ae(a){w.value=a.page,L.value=a.rows,m()}function I(a){D.value=a,D.value?C.value=Y($.value.mostProfitable):C.value=Y($.value.leastProfitable)}function z(a){M.value=a,M.value?B.value=$.value.mostProfitable:B.value=$.value.leastProfitable}const le={title:"Total Sales",icon:"pi pi-dollar",tooltip:"Total Sales",bgColor:"bg-blue-100"},se={data:"",title:"Total Profit",icon:"pi pi-tag",tooltip:"Total Profit",bgColor:"bg-gray-100"},ne={data:"",title:"Total COGS",icon:"pi pi-chart-line",tooltip:"Total COGS",bgColor:"bg-orange-100"};return(a,t)=>{const i=S("Chart"),s=S("InputText"),r=S("Column"),A=S("DataTable"),E=S("Paginator"),O=X("tooltip");return b(),x(Q,null,[e("div",we,[e("div",Te,[e("div",De,[l(ve,{showErrorMessage:j.value},null,8,["showErrorMessage"]),e("div",$e,[Me,e("div",Oe,[l(me,{onChange:m,salesChannelOption:g.value,"onUpdate:salesChannelOption":t[0]||(t[0]=o=>g.value=o)},null,8,["salesChannelOption"]),l(ge,{class:"flex flex-colunm flex-wrap",onHandleDateChange:m,onHandlePresetChange:m,preset:p.value,"onUpdate:preset":t[1]||(t[1]=o=>p.value=o),dates:c.value,"onUpdate:dates":t[2]||(t[2]=o=>c.value=o)},null,8,["preset","dates"])])]),e("div",ke,[e("div",Ve,[l(W,H(le,{data:"$431,227.00"}),null,16)]),e("div",Le,[l(W,H(se,{data:"$123,152.00"}),null,16)]),e("div",Re,[l(W,H(ne,{data:"$308,075.00"}),null,16)])]),e("div",Ne,[e("div",Ue,[e("div",Ae,[Ee,e("div",null,[e("button",{onClick:t[3]||(t[3]=o=>I(!0)),class:P(["toggle-button",D.value?"active":""])},"most profitable",2),e("button",{onClick:t[4]||(t[4]=o=>I(!1)),class:P(["toggle-button",D.value?"":"active"])},"least profitable",2)])]),l(i,{style:{height:"350px"},type:"bar",data:C.value,options:K.value},null,8,["data","options"])]),e("div",Ge,[e("div",je,[Be,e("div",null,[e("button",{onClick:t[5]||(t[5]=o=>z(!0)),class:P(["toggle-button",M.value?"active":null])},"highest",2),e("button",{onClick:t[6]||(t[6]=o=>z(!1)),class:P(["toggle-button",M.value?null:"active"])},"lowest",2)])]),(b(!0),x(Q,null,de(B.value,o=>(b(),x("div",Ie,[F((b(),x("div",ze,[h(d(o.productName),1)])),[[O,{value:o.productName,class:"item-name-tooltip"},void 0,{top:!0}]]),e("div",He,d(o.grossMargin)+"%",1)]))),256))])]),e("div",We,[e("span",Fe,[Ke,l(s,{style:{width:"400px"},onKeydown:t[7]||(t[7]=pe(o=>_(f).searchOnEnter(m),["enter"])),"onUpdate:modelValue":[t[8]||(t[8]=o=>_(f).debounce(m)),t[9]||(t[9]=o=>y.value=o)],modelValue:y.value,placeholder:"Search by Product Name or UPC Code"},null,8,["modelValue"])])]),l(A,{stripedRows:"",value:u.value,paginator:!1,class:"p-datatable-gridlines",dataKey:"id",rowHover:!0,filterDisplay:"menu",responsiveLayout:"scroll"},{empty:v(()=>[h(" No sales data. ")]),loading:v(()=>[h(" Loading sales data. Please wait. ")]),default:v(()=>[l(r,{header:"Product Name"},{body:v(({data:o})=>[F((b(),x("p",Ye,[h(d(o.name),1)])),[[O,{value:o.name,class:"item-name-tooltip"},void 0,{top:!0}]])]),_:1}),l(r,{field:"upc",header:"UPC Code"}),l(r,{field:"unitsSold",header:"Units Sold"}),l(r,{header:"Total Sales"},{body:v(({data:o})=>[h(d(_(f).formatCurrency(o.totalSales)),1)]),_:1}),l(r,{field:"unitsRefunded",header:"Units Refunded"}),l(r,{header:"ELC"},{body:v(({data:o})=>[e("span",Ze,d(_(f).formatCurrency(o.elc)),1)]),_:1}),l(r,{header:"Total Costs"},{body:v(({data:o})=>[e("span",qe,d(_(f).formatCurrency(o.totalCosts)),1)]),_:1}),l(r,{header:"Total Profit"},{body:v(({data:o})=>[h(d(_(f).formatCurrency(o.totalProfit)),1)]),_:1}),l(r,{field:"roi",header:"ROI"}),l(r,{header:"Gross Margin"},{body:v(({data:o})=>[h(d(_(f).formatPercentage(o.grossMargin)),1)]),_:1})]),_:1},8,["value"]),l(E,{onPage:ae,rows:20,totalRecords:V.value,rowsPerPageOptions:[10,20,30]},null,8,["totalRecords"])])])]),l(fe,{showLoadingModal:G.value},null,8,["showLoadingModal"])],64)}}};export{ot as default};
